From ed2365dfa2a22256617f63ad1024d4a0e258ac7b Mon Sep 17 00:00:00 2001
From: dan <dan@noemail.net>
Date: Sat, 16 May 2020 17:26:58 +0000
Subject: [PATCH 4/8] Fix a use-after-free bug in the fts3 snippet() function.

FossilOrigin-Name: 0d69f76f0865f9626078bee087a22fb826407279e78cf9d5382e1c985c9f64a9

Upstream-status: Backport https://github.com/sqlite/sqlite/commit/becd68ba0dac41904aa817d96a67fb4685734b41
CVE: CVE-2020-13630

Signed-off-by: Rahul Kumar <rahulk@mvista.com>
Signed-off-by: Anand Je Sypureddy <anandje@mvista.com>
---
 sqlite3.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/sqlite3.c b/sqlite3.c
index 6f44cc6..f27179b 100644
--- a/sqlite3.c
+++ b/sqlite3.c
@@ -170272,6 +170272,7 @@ static void fts3EvalNextRow(
                 fts3EvalNextRow(pCsr, pLeft, pRc);
               }
             }
+            pRight->bEof = pLeft->bEof = 1;
           }
         }
         break;
-- 
2.27.0

