From 37c4a02f6361dad8d22345dbe956c9a7fc4ce059 Mon Sep 17 00:00:00 2001
From: Nikos Mavrogiannopoulos <nmav@redhat.com>
Date: Wed, 13 Jun 2018 12:55:02 +0200
Subject: [PATCH 5/5] tests: pkcs12_encode: fix test for SHA512

We don't support SHA512 in the 3.5.x branch.

Signed-off-by: Nikos Mavrogiannopoulos <nmav@redhat.com>

Upstream-Status: Backport
CVE: CVE-2018-10844
CVE: CVE-2018-10845
CVE: CVE-2018-10846

Signed-off-by: Sam Kappen <skappen@mvista.com>
---
 tests/pkcs12_encode.c | 12 ------------
 1 file changed, 12 deletions(-)

diff --git a/tests/pkcs12_encode.c b/tests/pkcs12_encode.c
index 46c5092..e457557 100644
--- a/tests/pkcs12_encode.c
+++ b/tests/pkcs12_encode.c
@@ -220,18 +220,6 @@ void doit(void)
 		exit(1);
 	}
 
-	ret = gnutls_pkcs12_generate_mac2(pkcs12, GNUTLS_MAC_SHA512, "passwd1");
-	if (ret < 0) {
-		fprintf(stderr, "generate_mac2: %s (%d)\n", gnutls_strerror(ret), ret);
-		exit(1);
-	}
-
-	ret = gnutls_pkcs12_verify_mac(pkcs12, "passwd1");
-	if (ret < 0) {
-		fprintf(stderr, "verify_mac2: %s (%d)\n", gnutls_strerror(ret), ret);
-		exit(1);
-	}
-
 	size = sizeof(outbuf);
 	ret =
 	    gnutls_pkcs12_export(pkcs12, GNUTLS_X509_FMT_PEM, outbuf,
-- 
2.7.4

