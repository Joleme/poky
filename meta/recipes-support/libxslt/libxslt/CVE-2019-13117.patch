From 40af9738b9d18c7d98b395df1cb1a452462d12df Mon Sep 17 00:00:00 2001
From: Nick Wellnhofer <wellnhofer@aevum.de>
Date: Sat, 27 Apr 2019 11:19:48 +0200
Subject: [PATCH 1/2] Fix uninitialized read of xsl:number token

Found by OSS-Fuzz.

CVE: CVE-2019-13117
Upstream-Status: Backport
Signed-off-by: Sam Kappen <skappen@mvista.com>
---
 libxslt/numbers.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/libxslt/numbers.c b/libxslt/numbers.c
index e769c42..0466884 100644
--- a/libxslt/numbers.c
+++ b/libxslt/numbers.c
@@ -407,7 +407,10 @@ xsltNumberFormatTokenize(const xmlChar *format,
 		tokens->tokens[tokens->nTokens].token = val - 1;
 		ix += len;
 		val = xmlStringCurrentChar(NULL, format+ix, &len);
-	    }
+	    } else {
+                tokens->tokens[tokens->nTokens].token = (xmlChar)'0';
+                tokens->tokens[tokens->nTokens].width = 1;
+            }
 	} else if ( (val == (xmlChar)'A') ||
 		    (val == (xmlChar)'a') ||
 		    (val == (xmlChar)'I') ||
-- 
2.13.7

