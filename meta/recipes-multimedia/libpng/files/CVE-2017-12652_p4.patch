From 8f13e227fdd09f1d4b211f437225e6d34ff111f6 Mon Sep 17 00:00:00 2001
From: Glenn Randers-Pehrson <glennrp at users.sourceforge.net>
Date: Thu, 3 Aug 2017 16:29:58 -0500
Subject: [PATCH] Use png_debug2() instead of printf() for bug reporting.

Upstream-Status: Backport (patch #4)
CVE: CVE-2017-12652
Signed-off-by: Sunil Kumar <sukumar@mvista.com>
---
 pngpread.c | 2 +-
 pngrutil.c | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/pngpread.c b/pngpread.c
index 6445623..e5c47ad 100644
--- a/pngpread.c
+++ b/pngpread.c
@@ -253,7 +253,7 @@ png_push_read_chunk(png_structrp png_ptr, png_inforp info_ptr)
    }
    if (png_ptr->push_length > limit)
    {
-      printf(" png_ptr->push_length = %lu, limit = %lu\n",
+      png_debug2(1," png_ptr->push_length = %lu, limit = %lu",
          (unsigned long)png_ptr->push_length,(unsigned long)limit);
       png_chunk_error(png_ptr, "chunk data is too large");
    }
diff --git a/pngrutil.c b/pngrutil.c
index 792b4d9..325acc2 100644
--- a/pngrutil.c
+++ b/pngrutil.c
@@ -213,8 +213,8 @@ png_read_chunk_header(png_structrp png_ptr)
 
    if (length > limit)
    {
-      printf(" length = %lu, limit = %lu\n",
-         (unsigned long)length,(unsigned long)limit);
+      png_debug2(1," png_ptr->push_length = %lu, limit = %lu",
+         (unsigned long)png_ptr->push_length,(unsigned long)limit);
       png_chunk_error(png_ptr, "chunk data is too large");
    }
 
-- 
2.7.4

