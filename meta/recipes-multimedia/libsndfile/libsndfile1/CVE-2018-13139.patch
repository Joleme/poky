Author: Takashi Iwai 

Fix a stack-based buffer overflow in psf_memset in
common.c that allows remote attackers to cause a denial of service

Upstream-Status: Inappropriate [bugfix (https://bugzilla.suse.com/attachment.cgi?id=776234&action=edit)]
CVE: CVE-2018-13139

Signed-off-by: Jagadeesh Krishnanjanappa <jkrishnanjanappa@mvista.com>
diff --git a/programs/sndfile-deinterleave.c b/programs/sndfile-deinterleave.c
index 5366031075ab..712cb96cda76 100644
--- a/programs/sndfile-deinterleave.c
+++ b/programs/sndfile-deinterleave.c
@@ -89,6 +89,11 @@ main (int argc, char **argv)
 		exit (1) ;
 		} ;
 
+	if (sfinfo.channels > MAX_CHANNELS)
+	{	printf ("\nError : Too many channels %d in input file '%s'.\n", sfinfo.channels, argv[1]) ;
+		exit (1) ;
+		}
+
 	state.channels = sfinfo.channels ;
 	sfinfo.channels = 1 ;
 
