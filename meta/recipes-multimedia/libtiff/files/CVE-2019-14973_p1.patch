From d67d4a4b5268d38670bd017b7107f013b0cbbe01 Mon Sep 17 00:00:00 2001
From: Even Rouault <even.rouault@spatialys.com>
Date: Sat, 23 Mar 2019 11:20:18 +0100
Subject: [PATCH 1/2] tif_pixarlog.c: avoid false positive Coverity Scan
 warnings about overflow. CID 1400300 and 1400367

Upstream-Status: backport (patch #1)
CVE:  CVE-2019-14973
Signed-off-by: Rohit Raj <rohitr@mvista.com>
---
 libtiff/tif_pixarlog.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/libtiff/tif_pixarlog.c b/libtiff/tif_pixarlog.c
index 979858d..7a242e2 100644
--- a/libtiff/tif_pixarlog.c
+++ b/libtiff/tif_pixarlog.c
@@ -642,6 +642,7 @@ PixarLogGuessDataFmt(TIFFDirectory *td)
 static tmsize_t
 multiply_ms(tmsize_t m1, tmsize_t m2)
 {
+        assert(m1 >= 0 && m2 >= 0);
         if( m1 == 0 || m2 > TIFF_TMSIZE_T_MAX / m1 )
             return 0;
         return m1 * m2;
@@ -650,6 +651,7 @@ multiply_ms(tmsize_t m1, tmsize_t m2)
 static tmsize_t
 add_ms(tmsize_t m1, tmsize_t m2)
 {
+        assert(m1 >= 0 && m2 >= 0);
 	/* if either input is zero, assume overflow already occurred */
 	if (m1 == 0 || m2 == 0)
 		return 0;
-- 
2.7.4

